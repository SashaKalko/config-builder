<!doctype html>
<html lang="de">

<head>
    <meta charset="utf-8">

    <title>Java Config-Builder</title>

    <meta name="description" content="A framework for easily creating beautiful presentations using HTML">
    <meta name="author" content="Thomas Endres">

    <meta name="apple-mobile-web-app-capable" content="yes"/>
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"/>

    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
   
    <link rel="stylesheet" href="css/reveal.min.css">
    <link rel="stylesheet" href="css/theme/default.css" id="theme">

    <!-- For syntax highlighting -->
    <link rel="stylesheet" href="lib/css/zenburn.css">

    <link rel="stylesheet" href="css/print/pdf.css" type="text/css" media="print">

    <!--[if lt IE 9]>
    <script src="lib/js/html5shiv.js"></script>
    <![endif]-->
</head>

<body>
<div class="reveal">

    <!-- Any section element inside of this container is displayed as a slide -->
    <div class="slides">
 <section>
  <p style="margin-top: 250px;">
   <h1>Java Config-Builder</h1>
  </p>
</section>
<section>
 <h2>Motivation</h2>

  <div class="animated-html" style="overflow: hidden;">
    <animation duration="500"><animate data-id="bild1" data-property="opacity" data-value="1"></animate></animation>
    <animation duration="500"><animate data-id="bild2" data-property="opacity" data-value="1"></animate></animation>
    <animation duration="1 00"><animate data-id="bilder" data-property="opacity" data-value="0"></animate></animation>
    <animation duration="200"><animate data-id="head1" data-property="opacity" data-value="1"></animate></animation>
    <animation duration="200"><animate data-id="head2" data-property="opacity" data-value="1"></animate></animation>
    <animation duration="200"><animate data-id="line1" data-property="opacity" data-value="1"></animate></animation>
    <animation duration="200"><animate data-id="line2" data-property="opacity" data-value="1"></animate></animation>
    <animation duration="200"><animate data-id="line3" data-property="opacity" data-value="1"></animate></animation>
    <animation duration="200"><animate data-id="line4" data-property="opacity" data-value="1"></animate></animation>
    <animation duration="200">
        <animate data-id="line5" data-property="opacity" data-value="1"></animate>
        <animate data-id="line6" data-property="opacity" data-value="1"></animate>
        <animate data-id="line7" data-property="opacity" data-value="1"></animate>
    </animation>
    <animation duration="200"><animate data-id="config" data-property="opacity" data-value="1"></animate></animation>
    <animation duration="200">
        <animate data-id="table2" data-property="opacity" data-value="0"></animate>
        <animate data-id="config" data-property="margin-top" data-value="200"></animate>
    </animation>

    <div id="bilder" style="opacity: 1;">
        <div id="bild1" style="opacity: 0; position:absolute; height:500px; margin-top:100px; margin-left:200px; border:0px; background:none;">
            <img src="img/thinker.png">
        </div>
        <div id="bild2" style="opacity: 0; position:absolute; height:300px; margin-left:400px; border:0; background:none;">
            <img src="img/idea.png" style="border:0px;">
        </div>
    </div>

    <div id="config" style="opacity:0; margin-top:450px; width:100%; font-size: 44px; position:absolute;">ConverterConfig</div>

    <table id="table1" border="0" style="font-size: 40px; width:100%;">
        <tr>
            <th id="head1" style="opacity: 0; text-align:center">DBConverter</th>
            <th id="head2" style="opacity: 0; text-align:center">RuleConverter</th>
        </tr>
</table>
<table id="table2" border="0" style="font-size: 32px; width:100%; margin-top:50px">
        <tr id="line1" style="opacity: 0">
            <td style="text-align:center">CommandLineOptionsParser</td>
            <td style="text-align:center">CommandLineOptionsLoader</td>
        </tr>
        <tr id="line2" style="opacity: 0">
    <td style="text-align:center">ConfigPropertiesLoader</td>
    <td style="text-align:center">PropertyLoader</td>
  </tr>
  <tr id="line3" style="opacity: 0">
    <td style="text-align:center">ConfigDeterminer</td>
    <td style="text-align:center">ConfigBuilder</td>
  </tr>
  <tr id="line4" style="opacity: 0">
    <td style="text-align:center">ConfigManager</td>
    <td style="text-align:center">ConfigProvider</td>
  </tr>
  <tr id="line5" style="opacity: 0">
    <td style="text-align:center">PropertiesResourceLoader</td>
  </tr>
  <tr id="line6" style="opacity: 0">
    <td style="text-align:center">BeanMerger</td>
  </tr>
  <tr id="line7" style="opacity: 0">
    <td style="text-align:center">ConfigValidator</td>
  </tr>

</table>
    
  </div>
</section>

<section>
 <h2>Features</h2>

 <ul class="fragment fade-in" data-fragment-index="2" style="position:absolute; margin-left:-450px; margin-top:150px; width:100%;">
  <ul class="fragment fade-out" data-fragment-index="6"> 
   <li class="fragment fade-in" data-fragment-index="2">Properties-Dateien</li>
   <li class="fragment fade-in" data-fragment-index="3">System Properties</li>
   <li class="fragment fade-in" data-fragment-index="4">Umgebungsvariablen</li>
   <li class="fragment fade-in" data-fragment-index="5">Kommandozeile</li>
  </ul>
 </ul>
 <ul class="fragment fade-in" data-fragment-index="14" style="position:absolute; margin-left:-450px; margin-top:190px;">
  <ul class="fragment fade-out" data-fragment-index="17"> 
   <li class="fragment fade-in" data-fragment-index="14">primitive Typen</li>
   <li class="fragment fade-in" data-fragment-index="15">beliebige Objekte</li>
   <li class="fragment fade-in" data-fragment-index="16">Collections</li>
  </ul>
 </ul>

  <ul style="margin-top:100px; width:100%;">
   <li class="fragment" data-fragment-index="1">Laden von Werten aus verschiedenen Quellen</li>
   <li class="fragment" data-fragment-index="6">"Umwandlung" geladener String-Werte</li>
   <li class="fragment" data-fragment-index="17">"Bauen" vollständig konfigurierter Instanzen</li>
   <li class="fragment" data-fragment-index="18">Vervollständigen bestehender Instanzen</li>
 </ul>

 <div class="fragment fade-in" data-fragment-index="2"><pre class="fragment fade-out" data-fragment-index="3"><code class="java" style="position:absolute; font-size: 18px; margin-top: 100px; width:100%;">
@PropertyValue("user.name")
private String userName;
 </pre></code></div>
 <div class="fragment fade-in" data-fragment-index="3"><pre class="fragment fade-out" data-fragment-index="4"><code class="java" style="position:absolute; font-size: 18px; margin-top: 100px; width:100%;">
@SystemPropertyValue("user.name")
private String userName;
 </pre></code></div>
 <div class="fragment fade-in" data-fragment-index="4"><pre class="fragment fade-out" data-fragment-index="5"><code class="java" style="position:absolute; font-size: 18px; margin-top: 100px; width:100%;">
@EnvironmentVariableValue("PATH")
private String path;
 </pre></code></div>
 <div class="fragment fade-in" data-fragment-index="5"><pre class="fragment fade-out" data-fragment-index="6"><code class="java" style="position:absolute; font-size: 18px; margin-top: 100px; width:100%;">
@CommandLineValue(shortOpt="u", longOpt="user", hasArg="true")
private String userName;
 </pre></code></div>

</section>

<section>
 <section>
  <h2 style="margin-top: 280px;">Klingt ja toll, aber was muss ich tun?</h2>
 </section>
 <section>
  <h3>1. Klasse erstellen</h3>
  <pre><code class="java" data-trim contenteditable style="font-size: 18px; margin-top: 20px;">
public class MyConfig {

    private boolean runInTestMode;
    private int runLevel;
    private String path;
    private String userName;
    private Collection&lt;PidFix&gt; pidFixCollection
    private PidFix pidFix
    ...
}
  </code></pre>
 </section>
 <section>
  <h3>2. Annotieren</h3>
  <pre><code class="java" data-trim contenteditable style="font-size: 17px; margin-top: 20px; max-height:600px">
public class BarbecueConfig {
    @DefaultValue("false")
    @CommandLineValue(shortOpt="t", longOpt="test", hasArg="false")
    private boolean runInTestMode;

    @DefaultValue("3")
    @CommandLineValue(shortOpt="rl", longOpt="runLevel", hasArg="true")
    private int steaksPerHour;

    @EnvironmentVariableValue("PATH")
    @PropertyValue("path")
    private String path;

    @SystemPropertyValue("user.name")
    private String userName;

    @Collection
    @ValueProvider(PidFixFactory.class)
    @CommandLineValue(shortOpt="pc", longOpt="pidFixCollection", hasArg="true")
    private Collection&lt;PidFix&gt pidFixCollection

    @ValueProvider(PidFixFactory.class)
    @CommandLineValue(shortOpt="p", longOpt="pidFix", hasArg="true")
    private PidFix pidFix
    ...
}
  </code></pre>
 </section>
 <section>
  <h3>3. Optional: Property-Loader Konfigurieren</h3>
  <pre><code data-trim contenteditable style="font-size: 18px; margin-top: 20px;">
@PropertiesFiles("config")
@PropertyLocations(directories = {"/home/user"}, contextClassLoader = true)
@PropertySuffixes(extraSuffixes = {"tngtech","myname"}, hostNames = true)
public class MyConfig {
}
  </code></pre>
 </section>
 <section>
  <h3>4. Optional: Validierung</h3>
  <pre><code data-trim contenteditable style="font-size: 18px; margin-top: 20px;">
@NotEmpty("username.notEmpty")
private String userName;
  </code></pre>
  <pre><code data-trim contenteditable style="font-size: 18px; margin-top: 20px;">
@Validation
private void validate() {
    <...>
}
  </code></pre>
 </section>
 <section>
  <h3>5. Optional: Konstruktor</h3>
  <pre><code data-trim contenteditable style="font-size: 18px; margin-top: 20px;">
public class MyConfig {
    public MyConfig(ConverterMode mode) {
        this.converterMode = mode;
    }
}
  </code></pre>
 </section>
</section>
<section>
 <h2>Funktionsweise</h2>
  <ul style="margin-top:100px">
   <li class="fragment">lade Properties</li>
   <li class="fragment">verarbeite Command Line Options</li>
   <li class="fragment">finde passenden Konstruktor</li>
   <li class="fragment">instantiiere Config-Objekt</li>
   <li class="fragment">setze Felder</li>
   <li class="fragment">validiere</li>
 </ul>
</section>
<section>
 <h2>Kleiner Footprint</h2>
  <ul style="margin-top:100px">
   <li class="fragment">Property-Loader</li>
   <li class="fragment">Apache CLI</li>
   <li class="fragment">JSR303</li>
   <li class="fragment">Google Guava</li>
 </ul>
</section>
<section>
 <section>
  <h2>Der Property-Loader</h2>
 </section>
 <section>
  <h3>Features</h3>

  <ul class="fragment fade-in" data-fragment-index="2" style="position:absolute; margin-top:200px; margin-left: -450px;">
   <ul class="fragment fade-out" data-fragment-index="6"> 
    <li class="fragment fade-in" data-fragment-index="2">Pfade und URLs</li>
    <li class="fragment fade-in" data-fragment-index="3">Klassenpfad</li>
    <li class="fragment fade-in" data-fragment-index="4">relativ zu Klasse</li>
    <li class="fragment fade-in" data-fragment-index="5">ClassLoader</li>
   </ul>
  </ul>
  <ul class="fragment fade-in" data-fragment-index="8" style="position:absolute; margin-top:240px; margin-left: -450px;">
   <ul class="fragment fade-out" data-fragment-index="11"> 
    <li class="fragment fade-in" data-fragment-index="8">Local Hostames</li>
    <li class="fragment fade-in" data-fragment-index="9">Benutzername</li>
    <li class="fragment fade-in" data-fragment-index="10">eigene Suffixes</li>
   </ul>
  </ul>
  <ul class="fragment fade-in" data-fragment-index="12" style="position:absolute; margin-top:280px; margin-left: -450px;">
   <ul> 
    <li class="fragment fade-in" data-fragment-index="12">Variablen-Auflösung</li>
    <li class="fragment fade-in" data-fragment-index="13">Umgebungsvariablen</li>
    <li class="fragment fade-in" data-fragment-index="14">System Properties</li>
    <li class="fragment fade-in" data-fragment-index="15">Includes</li>
    <li class="fragment fade-in" data-fragment-index="16">Encryption/Decryption</li>
   </ul>
  </ul>
  <ul style="margin-top:100px">
   <li class="fragment" data-fragment-index="1">Hierarchisches Finden und Laden von Key-Value Dateien (Properties/XML)</li>
   <li class="fragment" data-fragment-index="7">Suffixes</li>
   <li class="fragment" data-fragment-index="11">Postprocessing</li>
  </ul>

 <div class="fragment fade-in" data-fragment-index="12"><pre class="fragment fade-out" data-fragment-index="13"><code class="java" style="position:absolute; font-size: 18px; margin-top: 300px; width:100%;">
{$nested{$variable}}
 </pre></code></div>
 <div class="fragment fade-in" data-fragment-index="13"><pre  class="fragment fade-out" data-fragment-index="14"><code class="java" style="position:absolute; font-size: 18px; margin-top: 300px; width:100%;">
...
 </pre></code></div>
 <div class="fragment fade-in" data-fragment-index="14"><pre class="fragment fade-out" data-fragment-index="15"><code class="java" style="position:absolute; font-size: 18px; margin-top: 300px; width:100%;">
%include=file1,file2,file3
 </pre></code></div>
 <div class="fragment fade-in" data-fragment-index="15"><pre class="fragment fade-out" data-fragment-index="16"><code class="java" style="position:absolute; font-size: 18px; margin-top: 300px; width:100%;">
key = DECRYPT:value
 </pre></code></div>

 </section>
 <section>
  <h3 style="margin-top: 280px;">Nutzung</h3>
 </section>
 <section>
  <h3>Such-Orte</h3>

  <ul style="margin-top:100px; width:100%;">
   <li class="fragment" data-fragment-index="1">Standard-Suchorte</li>
   <li class="fragment" data-fragment-index="6">Pfade und URLs</li>
   <li class="fragment" data-fragment-index="7">Klassenpfad des Threads</li>
   <li class="fragment" data-fragment-index="8">ClassLoader</li>
   <li class="fragment" data-fragment-index="9">relativ zu Klasse</li>
 </ul>

 <div class="fragment fade-in" data-fragment-index="1"><pre class="fragment fade-out" data-fragment-index="6"><code class="java" style="position:absolute; font-size: 18px; margin-top: 100px; width:100%;">
propertyLoader.atDefaultLocations()
 </pre></code></div>
 <div class="fragment fade-in" data-fragment-index="6"><pre class="fragment fade-out" data-fragment-index="7"><code class="java" style="position:absolute; font-size: 18px; margin-top: 100px; width:100%;">
propertyLoader.atDirectory(String directory)
propertyLoader.atBaseURL(URL url)
propertyLoader.atCurrentDirectory()
propertyLoader.atHomeDirectory()
 </pre></code></div>
 <div class="fragment fade-in" data-fragment-index="7"><pre class="fragment fade-out" data-fragment-index="8"><code class="java" style="position:absolute; font-size: 18px; margin-top: 100px; width:100%;">
propertyLoader.atContextClassPath()
 </pre></code></div>
 <div class="fragment fade-in" data-fragment-index="8"><pre class="fragment fade-out" data-fragment-index="9"><code class="java" style="position:absolute; font-size: 18px; margin-top: 100px; width:100%;">
propertyLoader.atClassLoader(ClassLoader classLoader)
 </pre></code></div>
 <div class="fragment fade-in" data-fragment-index="9"><pre><code class="java" style="position:absolute; font-size: 18px; margin-top: 100px; width:100%;">
propertyLoader.atRelativeToClass(Class<?> clazz) 
 </pre></code></div>

 </section>
 <section>
  <h3>Suffixes</h3>

  <ul style="margin-top:100px; width:100%;">
   <li class="fragment" data-fragment-index="1">Standard-Suffixes</li>
   <li class="fragment" data-fragment-index="6">Local Hostnames</li>
   <li class="fragment" data-fragment-index="7">Benutzername</li>
   <li class="fragment" data-fragment-index="8">eigene Suffixes</li>
 </ul>

 <div class="fragment fade-in" data-fragment-index="1"><pre class="fragment fade-out" data-fragment-index="6"><code class="java" style="position:absolute; font-size: 18px; margin-top: 100px; width:100%;">
propertyLoader.addDefaultSuffixes()
 </pre></code></div>
 <div class="fragment fade-in" data-fragment-index="6"><pre class="fragment fade-out" data-fragment-index="7"><code class="java" style="position:absolute; font-size: 18px; margin-top: 100px; width:100%;">
propertyLoader.addLocalHostNames()
 </pre></code></div>
 <div class="fragment fade-in" data-fragment-index="7"><pre class="fragment fade-out" data-fragment-index="8"><code class="java" style="position:absolute; font-size: 18px; margin-top: 100px; width:100%;">
propertyLoader.addUserName()
 </pre></code></div>
 <div class="fragment fade-in" data-fragment-index="8"><pre><code class="java" style="position:absolute; font-size: 18px; margin-top: 100px; width:100%;">
propertyLoader.addSuffix(String directory)
propertyLoader.addSuffixList(List<String> suffixes)
 </pre></code></div>

 </section>
 <section>

  <h3>Postprocessing</h3>



  <pre><code class="java" style="font-size: 18px; margin-top: 20px;">
propertyLoader.withDefaultFilters() 
propertyLoader.withVariableResolvingFilter() 
propertyLoader.withEnvironmentResolvingFilter() 
propertyLoader.withDecryptingFilter()
propertyLoader.withWarnIfPropertyHasToBeDefined() 
propertyLoader.withWarnOnSurroundingWhitespace() 
  </pre></code>
 </section>
</section>
<section>
 <h2>Java Magie</h2>
  <ul style="margin-top:100px">
   <li class="fragment">Annotations</li>
   <li class="fragment">Reflections</li>
 </ul>
</section>
<section>
 <section>
  <h2>Annotations</h2>
 </section>
 <section>
  <h3>Beispiel</h3>
  <pre><code class="java" style="font-size: 18px; margin-top: 20px;">
@ValueExtractorAnnotation(CommandLineValueProcessor.class)
@Target(ElementType.FIELD)
@Retention(RetentionPolicy.RUNTIME)
public @interface CommandLineValue {
    String shortOpt();
    String longOpt();
    String description() default "";
    boolean hasArg() default false;
    boolean required() default false;
}
  </pre></code>
 </section>
 <section>
  <h3>Probleme</h3>
  <ul style="margin-top:100px">
   <li class="fragment">keine Implementierung von Methoden-Rümpfen</li>
   <li class="fragment">keine Vererbung</li>
   <li class="fragment">beschränkte Auswahl an Typen: ...</li>
  </ul>
 </section>
 <section>
  <h3>Lösung</h3>
  <ul style="margin-top:100px">
   <li class="fragment">...</li>
   <li class="fragment">...</li>
   <li class="fragment">...</li>
  </ul>
 </section>
</section>
<section>
 <section>
  <h2>Reflections</h2>
   25.2 Metadaten der Klassen mit dem Class-Objekt
 	 	Pfeil	25.2.1 An ein Class-Objekt kommen
 	 	Pfeil	25.2.2 Was das Class-Objekt beschreibt *
 	 	Pfeil	25.2.3 Der Name der Klasse
 	 	Pfeil	25.2.4 »instanceof« mit Class-Objekten *
 	 	Pfeil	25.2.5 Oberklassen finden *
 	 	Pfeil	25.2.6 Implementierte Interfaces einer Klasse oder eines Interfaces *
 	 	Pfeil	25.2.7 Modifizierer und die Klasse »Modifier« *
 	 	Pfeil	25.2.8 Die Arbeit auf dem Feld *
 	Pfeil	25.3 Attribute, Methoden und Konstruktoren
 	 	Pfeil	25.3.1 Reflections – Gespür für Attribute einer Klasse
 	 	Pfeil	25.3.2 Methoden einer Klasse erfragen
 	 	Pfeil	25.3.3 Properties einer Bean erfragen
 	 	Pfeil	25.3.4 Konstruktoren einer Klasse
 	 	Pfeil	25.3.5 Annotationen
 	Pfeil	25.4 Objekte erzeugen und manipulieren
 	 	Pfeil	25.4.1 Objekte erzeugen
 	 	Pfeil	25.4.2 Die Belegung der Variablen erfragen
 	 	Pfeil	25.4.3 Eine generische eigene toString()-Methode *
 	 	Pfeil	25.4.4 Variablen setzen
 	 	Pfeil	25.4.5 Bean-Zustände kopieren *
 	 	Pfeil	25.4.6 Private Attribute ändern
 	Pfeil	25.5 Methoden aufrufen
 	 	Pfeil	25.5.1 Statische Methoden aufrufen
 </section>
</section>
<section>
  <h2>Open Source</h2>
    <p>https://github.com/TNG/config-builder</p>
    <p>https://github.com/TNG/property-loader</p>
  <h2 style="margin-top:100px">Maven Central</h2>
    <pre><code class="xml">&lt;dependency&gt;
    &lt;groupId&gt;com.tngtech.java&lt;/groupId&gt;
    &lt;artifactId&gt;config-builder&lt;/artifactId&gt;
    &lt;version&gt;1.0&lt;/version&gt;
&lt;/dependency&gt;</pre></code>
    <pre><code class="xml">&lt;dependency&gt;
    &lt;groupId&gt;com.tngtech.java&lt;/groupId&gt;
    &lt;artifactId&gt;property-loader&lt;/artifactId&gt;
    &lt;version&gt;1.1&lt;/version&gt;<br>
&lt;/dependency&gt;</pre></code>
</section>



<!-- The navigational controls UI -->
    <aside class="controls">
        <a class="left" href="#">&#x25C4;</a>
        <a class="right" href="#">&#x25BA;</a>
        <a class="up" href="#">&#x25B2;</a>
        <a class="down" href="#">&#x25BC;</a>
    </aside>

<!-- Presentation progress bar -->
    <div class="progress"><span></span></div>

</div>

<script src="js/jquery.1.10.2.js"></script>
<script src="plugin/animate/jquery.browser.js"></script>
<script src="plugin/animate/jquery.svg.js"></script>
<script src="plugin/animate/jquery.svganim.js"></script>

<script src="lib/js/head.min.js"></script>
<script src="js/reveal.min.js"></script>

<script>

    // Full list of configuration options available here:
    // https://github.com/hakimel/reveal.js#configuration
    Reveal.initialize({
        
        margin:0,
        height:800,
        width:1000,

        //minScale: 1.0,
        //maxScale: 1.0,

        controls: false,
        progress: false,
        history: true,
        center: false,

        theme: 'sky', // available themes are in /css/theme
        transition: 'linear', // default/cube/page/concave/zoom/linear/fade/none

        // Optional libraries used to extend on reveal.js
        dependencies: [
            { src: 'lib/js/classList.js', condition: function() {
                return !document.body.classList;
            } },
            { src: 'plugin/markdown/marked.js', condition: function() {
                return !!document.querySelector('[data-markdown]');
            } },
            { src: 'plugin/markdown/markdown.js', condition: function() {
                return !!document.querySelector('[data-markdown]');
            } },
            { src: 'plugin/highlight/highlight.js', async: true, callback: function() {
                hljs.initHighlightingOnLoad();
            } },
            { src: 'plugin/zoom-js/zoom.js', async: true, condition: function() {
                return !!document.body.classList;
            } },
            { src: 'plugin/notes/notes.js', async: true, condition: function() {
                return !!document.body.classList;
            } },
            { src: 'plugin/animate/reveal.animate.js', async: true, callback: function() {
                var animator = Reveal.Animate();
                animator.initialize();
                animator.addAnimationProvider('.animated-svg', Reveal.Animate.Svg());
                animator.addAnimationProvider('.animated-html', Reveal.Animate.Html());
                animator.setPrintValues();
            } }
        ]
    });

</script>

</body>
</html>
